"use strict";(globalThis["webpackChunkqwitter"]=globalThis["webpackChunkqwitter"]||[]).push([[619],{5619:(e,t,l)=>{l.r(t),l.d(t,{default:()=>E});var o=l(9835),i=l(499),n=l(6970),a=l(1957),r=l(6038),s=l(1709),u=l(1334),c=l(9302),d=function(e,t,l,o){function i(e){return e instanceof l?e:new l((function(t){t(e)}))}return new(l||(l=Promise))((function(l,n){function a(e){try{s(o.next(e))}catch(t){n(t)}}function r(e){try{s(o["throw"](e))}catch(t){n(t)}}function s(e){e.done?l(e.value):i(e.value).then(a,r)}s((o=o.apply(e,t||[])).next())}))};const p=["src"],m={class:"relative-position",style:{"flex-grow":"1"}},v=["src"],w={class:"text-grey-5 q-px-sm text-caption"},f={key:0,class:"q-ml-sm q-mt-sm q-pa-sm text-weight-regular text-grey-7 re-qwitt"},g={class:"row justify-between q-mt-sm qwitt-icons"},_={class:"row flex-center"},q={class:"text-overline text-weight-light"},h=(0,o._)("div",{class:"text-h6"},"Your Qwitt",-1),y=(0,o.aZ)({__name:"HomePage",setup(e){const t=(0,c.Z)(),l=(0,u.L)(),y=(0,i.iH)(""),{supabase:k}=(0,s["default"])(),W=(0,i.qj)([]),b=(0,i.iH)(!1);let x=null;const Q=()=>d(this,void 0,void 0,(function*(){var e;try{const{data:t,error:o}=yield k.from("qwitts").select("id, qwitt, created_at, qwitt_id, profiles!profile_id(*),likes(*), count:likes(count)").eq("likes.profile_id",null===(e=l.authUser)||void 0===e?void 0:e.id.toString()).order("created_at",{ascending:!1});if(o)throw o;W.push(...t)}catch(o){o instanceof Error?(console.log(o),t.notify({type:"negative",message:" oops an error occurred ",caption:o.message,timeout:2500})):(console.log("Unexpected error",o),t.notify({type:"negative",message:" oops an error occurred ",timeout:2500}))}})),Z=()=>d(this,void 0,void 0,(function*(){var e;const o={qwitt:y.value,profile_id:null===(e=l.userProfile)||void 0===e?void 0:e.id,profiles:l.userProfile,qwitt_id:x,likes:[]};y.value="";const i=t.notify({group:!1,message:" please wait...",spinner:!0,timeout:0});try{const{data:e,error:t}=yield k.from("qwitts").insert({qwitt:o.qwitt,profile_id:o.profile_id,qwitt_id:o.qwitt_id}).select();if(t)throw t;o.id=e[0].id,o.created_at=e[0].created_at,W.unshift(o),i({icon:"done",spinner:!1,type:"positive",message:" it,s done",timeout:2500})}catch(n){n instanceof Error?(console.log(n),i({type:"negative",spinner:!1,message:" oops an error occurred",caption:n.message,timeout:2500})):(console.log("Unexpected error",n),t.notify({type:"negative",message:" oops an error occurred ",spinner:!1,timeout:2500}))}})),C=e=>d(this,void 0,void 0,(function*(){var t,o,i,n,a,r;const s={profile_id:null===(t=l.authUser)||void 0===t?void 0:t.id,qwitt_id:e.id};if(null===(o=e.likes)||void 0===o?void 0:o.length)try{const{error:t}=yield k.from("likes").delete().eq("profile_id",s.profile_id).eq("qwitt_id",s.qwitt_id);if(t)throw t;null===(i=e.likes)||void 0===i||i.splice(0),(null===(n=e.count)||void 0===n?void 0:n.length)&&e.count[0].count&&e.count[0].count--}catch(u){console.log(u)}else try{const{error:t}=yield k.from("likes").insert([s]);if(t)throw t;null===(a=e.likes)||void 0===a||a.push(s),(null===(r=e.count)||void 0===r?void 0:r.length)&&(e.count[0].count?e.count[0].count++:e.count[0].count=1)}catch(u){console.log(u)}})),U=e=>{b.value=!0,x=e};return(0,o.YP)(b,(e=>{e||(x=null)})),Q(),(e,t)=>{const s=(0,o.up)("q-avatar"),u=(0,o.up)("q-icon"),c=(0,o.up)("q-btn"),d=(0,o.up)("q-input"),k=(0,o.up)("q-separator"),x=(0,o.up)("q-item-section"),Q=(0,o.up)("q-item-label"),z=(0,o.up)("q-item"),V=(0,o.up)("q-list"),P=(0,o.up)("q-scroll-area"),S=(0,o.up)("q-card-section"),j=(0,o.up)("q-card-actions"),I=(0,o.up)("q-card"),D=(0,o.up)("q-dialog"),H=(0,o.up)("q-page"),L=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.j4)(H,{class:"column"},{default:(0,o.w5)((()=>[b.value?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(d,{key:0,"bottom-slots":"",modelValue:y.value,"onUpdate:modelValue":t[2]||(t[2]=e=>y.value=e),label:"Label",class:"q-pa-md",counter:"",maxlength:"255",autogrow:""},{before:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>{var e;return[(0,o._)("img",{src:null===(e=(0,i.SU)(l).userProfile)||void 0===e?void 0:e.avatar_url},null,8,p)]})),_:1})])),append:(0,o.w5)((()=>[""!==y.value?((0,o.wg)(),(0,o.j4)(u,{key:0,name:"close",onClick:t[0]||(t[0]=e=>y.value=""),class:"cursor-pointer"})):(0,o.kq)("",!0),(0,o.Wm)(u,{name:"schedule"})])),hint:(0,o.w5)((()=>[(0,o.Uk)(" Field hint ")])),after:(0,o.w5)((()=>[(0,o.Wm)(c,{color:"primary",label:"Qwitter",disable:!(y.value.length>6),"no-caps":"",unelevated:"",rounded:"",onClick:t[1]||(t[1]=e=>Z())},null,8,["disable"])])),_:1},8,["modelValue"])),(0,o.Wm)(k,{class:"q-mt-md divider",size:"10px"}),(0,o._)("div",m,[(0,o.Wm)(P,{class:"absolute fullscreen"},{default:(0,o.w5)((()=>[(0,o.Wm)(V,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(W,((e,t)=>((0,o.wg)(),(0,o.j4)(z,{key:t,class:"q-py-md"},{default:(0,o.w5)((()=>[(0,o.Wm)(x,{top:"",avatar:""},{default:(0,o.w5)((()=>[(0,o.Wm)(s,null,{default:(0,o.w5)((()=>{var t;return[(0,o._)("img",{src:null===(t=e.profiles)||void 0===t?void 0:t.avatar_url},null,8,v)]})),_:2},1024)])),_:2},1024),(0,o.Wm)(x,null,{default:(0,o.w5)((()=>{var t,l,i;return[(0,o.Wm)(Q,{class:"text-subtitle1"},{default:(0,o.w5)((()=>{var t,l;return[(0,o._)("strong",null,(0,n.zw)(null===(t=e.profiles)||void 0===t?void 0:t.name),1),(0,o._)("span",w,(0,n.zw)(null===(l=e.profiles)||void 0===l?void 0:l.username),1)]})),_:2},1024),(0,o.Wm)(Q,{class:"text-body1 text-grey-8",lines:"6"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(e.qwitt),1)])),_:2},1024),e.qwitt_id?((0,o.wg)(),(0,o.iD)("div",f,(0,n.zw)(null===(t=W.find((t=>t.id===e.qwitt_id)))||void 0===t?void 0:t.qwitt),1)):(0,o.kq)("",!0),(0,o._)("div",g,[(0,o.Wm)(c,{flat:"",round:"",color:"grey",size:"sm",icon:"chat_bubble",onClick:t=>U(e.id?e.id:null)},null,8,["onClick"]),(0,o.Wm)(c,{flat:"",round:"",color:(null===(l=e.likes)||void 0===l?void 0:l.length)?"red":"grey",size:"sm",icon:"favorite",onClick:t=>C(e)},null,8,["color","onClick"]),(0,o._)("div",_,[(0,o._)("span",q,(0,n.zw)((null===(i=e.count)||void 0===i?void 0:i.length)?e.count[0].count:""),1),(0,o.Wm)(u,{color:"grey",size:"sm",name:"signal_cellular_alt"})])])]})),_:2},1024),(0,o.Wm)(x,{side:"",top:""},{default:(0,o.w5)((()=>[(0,o.Wm)(Q,{caption:""},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(e.created_at?(0,i.SU)(r.INm)(e.created_at):""),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)),(0,o.Wm)(k,{inset:""})])),_:1})])),_:1}),(0,o.Wm)(D,{modelValue:b.value,"onUpdate:modelValue":t[6]||(t[6]=e=>b.value=e),persistent:""},{default:(0,o.w5)((()=>[(0,o.Wm)(I,{style:{"min-width":"350px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(S,null,{default:(0,o.w5)((()=>[h])),_:1}),(0,o.Wm)(S,{class:"q-pt-none"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{dense:"",modelValue:y.value,"onUpdate:modelValue":t[3]||(t[3]=e=>y.value=e),autofocus:"",onKeyup:t[4]||(t[4]=(0,a.D2)((e=>b.value=!1),["enter"]))},null,8,["modelValue"])])),_:1}),(0,o.Wm)(j,{align:"right",class:"text-primary"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o.Wm)(c,{flat:"",label:"Cancel"},null,512),[[L]]),(0,o.wy)((0,o.Wm)(c,{flat:"",label:"Reply Qwitt",onClick:t[5]||(t[5]=e=>Z())},null,512),[[L]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])])),_:1})}}});var k=l(9885),W=l(7471),b=l(1357),x=l(2857),Q=l(8879),Z=l(926),C=l(6663),U=l(3246),z=l(490),V=l(1233),P=l(3115),S=l(2074),j=l(4458),I=l(3190),D=l(1821),H=l(2146),L=l(9984),A=l.n(L);const Y=y,E=Y;A()(y,"components",{QPage:k.Z,QInput:W.Z,QAvatar:b.Z,QIcon:x.Z,QBtn:Q.Z,QSeparator:Z.Z,QScrollArea:C.Z,QList:U.Z,QItem:z.Z,QItemSection:V.Z,QItemLabel:P.Z,QDialog:S.Z,QCard:j.Z,QCardSection:I.Z,QCardActions:D.Z}),A()(y,"directives",{ClosePopup:H.Z})}}]);